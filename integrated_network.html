

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Create an Integrated Transit and Street Network &mdash; UrbanAccess 0.2.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plot Networks" href="plot.html" />
    <link rel="prev" title="Download and Load Data" href="data_loaders.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> UrbanAccess
          

          
          </a>

          
            
            
              <div class="version">
                0.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction and Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_loaders.html">Download and Load Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Create an Integrated Transit and Street Network</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-network-data-object">The Network Data Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-transit-network">Creating a transit network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-street-network">Creating a street network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-integration">Network Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#save-network">Save Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#load-network">Load Network</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plot.html">Plot Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandana.html">Using an UrbanAccess network with Pandana</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Network Gallery</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">UrbanAccess</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Create an Integrated Transit and Street Network</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/integrated_network.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="create-an-integrated-transit-and-street-network">
<span id="network-section"></span><h1>Create an Integrated Transit and Street Network<a class="headerlink" href="#create-an-integrated-transit-and-street-network" title="Permalink to this headline">¶</a></h1>
<p>After loading the transit and street network data, UrbanAccess has tools to compute a travel time weighted graph network of nodes and edges for use with Pandana network accessibility queries.</p>
<div class="section" id="the-network-data-object">
<span id="network-data-object"></span><h2>The Network Data Object<a class="headerlink" href="#the-network-data-object" title="Permalink to this headline">¶</a></h2>
<p>The network data object stores the individual transit and street network node and edge components as well as the final integrated network in Pandas dataframes.</p>
<dl class="py data">
<dt id="urbanaccess.network.ua_network">
<code class="sig-prename descclassname">urbanaccess.network.</code><code class="sig-name descname">ua_network</code><a class="headerlink" href="#urbanaccess.network.ua_network" title="Permalink to this definition">¶</a></dt>
<dd><p>A urbanaccess object of Pandas DataFrames representing
the components of a graph network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>transit_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>transit_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>net_connector_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>osm_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>osm_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>net_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>net_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="creating-a-transit-network">
<span id="transit-network"></span><h2>Creating a transit network<a class="headerlink" href="#creating-a-transit-network" title="Permalink to this headline">¶</a></h2>
<p>Create a transit network from the loaded GTFS feeds with travel time impedance.</p>
<dl class="py function">
<dt id="urbanaccess.gtfs.network.create_transit_net">
<code class="sig-prename descclassname">urbanaccess.gtfs.network.</code><code class="sig-name descname">create_transit_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gtfsfeeds_dfs</span></em>, <em class="sig-param"><span class="n">day</span></em>, <em class="sig-param"><span class="n">timerange</span></em>, <em class="sig-param"><span class="n">calendar_dates_lookup</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite_existing_stop_times_int</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_existing_stop_times_int</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_processed_gtfs</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_dir</span><span class="o">=</span><span class="default_value">'data'</span></em>, <em class="sig-param"><span class="n">save_filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#urbanaccess.gtfs.network.create_transit_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a travel time weight network graph in units of
minutes from GTFS data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>gtfsfeeds_dfs</strong><span class="classifier">object</span></dt><dd><p>gtfsfeeds_dfs object with DataFrames of stops, routes, trips,
stop_times, calendar, calendar_dates (optional) and
stop_times_int (optional)</p>
</dd>
<dt><strong>day</strong><span class="classifier">{‘friday’, ‘monday’, ‘saturday’, ‘sunday’, ‘thursday’, ‘tuesday’,</span></dt><dd></dd>
<dt><strong>‘wednesday’}</strong></dt><dd><p>day of the week to extract transit schedule from that
corresponds to the day in the GTFS calendar</p>
</dd>
<dt><strong>timerange</strong><span class="classifier">list</span></dt><dd><p>time range to extract transit schedule from in a list with time
1 and time 2. it is suggested the time range
specified is large enough to allow for travel
from one end of the transit network to the other but small enough
to represent a relevant travel time period such as a 3 hour window
for the AM Peak period. Must follow format
of a 24 hour clock for example: 08:00:00 or 17:00:00</p>
</dd>
<dt><strong>calendar_dates_lookup</strong><span class="classifier">dict, optional</span></dt><dd><p>dictionary of the lookup column (key) as a string and corresponding
string (value) as string or list of strings to use to subset trips
using the calendar_dates DataFrame. Search will be exact. If none,
then the calendar_dates DataFrame will not be used to select trips
that are not in the calendar DataFrame. Note search will select all
records that meet each key value pair criteria.
Example: {‘schedule_type’ : ‘WD’} or {‘schedule_type’ : [‘WD’, ‘SU’]}</p>
</dd>
<dt><strong>overwrite_existing_stop_times_int</strong><span class="classifier">bool, optional</span></dt><dd><p>if true, and if there is an existing stop_times_int
DataFrame stored in the gtfsfeeds_dfs object it will be
overwritten</p>
</dd>
<dt><strong>use_existing_stop_times_int</strong><span class="classifier">bool, optional</span></dt><dd><p>if true, and if there is an existing stop_times_int
DataFrame for the same time period stored in the
gtfsfeeds_dfs object it will be used instead of re-calculated</p>
</dd>
<dt><strong>save_processed_gtfs</strong><span class="classifier">bool, optional</span></dt><dd><p>if true, all processed GTFS DataFrames will
be stored to disk in a hdf5 file</p>
</dd>
<dt><strong>save_dir</strong><span class="classifier">str, optional</span></dt><dd><p>directory to save the hdf5 file</p>
</dd>
<dt><strong>save_filename</strong><span class="classifier">str, optional</span></dt><dd><p>name to save the hdf5 file as</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ua_network</strong><span class="classifier">object</span></dt><dd></dd>
<dt><strong>ua_network.transit_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>ua_network.transit_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="creating-a-street-network">
<span id="street-network"></span><h2>Creating a street network<a class="headerlink" href="#creating-a-street-network" title="Permalink to this headline">¶</a></h2>
<p>Create a street network from the loaded OSM data with travel time impedance.</p>
<dl class="py function">
<dt id="urbanaccess.osm.network.create_osm_net">
<code class="sig-prename descclassname">urbanaccess.osm.network.</code><code class="sig-name descname">create_osm_net</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">osm_edges</span></em>, <em class="sig-param"><span class="n">osm_nodes</span></em>, <em class="sig-param"><span class="n">travel_speed_mph</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">network_type</span><span class="o">=</span><span class="default_value">'walk'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#urbanaccess.osm.network.create_osm_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a travel time weight network graph in units of minutes from
openstreetmap nodes and edges</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>osm_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>osm edge dataframe</p>
</dd>
<dt><strong>osm_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>osm node dataframe</p>
</dd>
<dt><strong>travel_speed_mph</strong><span class="classifier">int, optional</span></dt><dd><p>travel speed to use to calculate travel time across a
distance on a edge. units are in miles per hour (MPH)
for pedestrian travel this is assumed to be 3 MPH</p>
</dd>
<dt><strong>network_type</strong><span class="classifier">str, optional</span></dt><dd><p>default is ‘walk’ for the osm pedestrian network.
this string is used to label the osm network once it is
integrated with the transit network</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ua_network</strong><span class="classifier">object</span></dt><dd><p>urbanaccess_network object with osm_edges and osm_nodes dataframes</p>
</dd>
<dt><strong>ua_network.osm_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>ua_network.osm_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="network-integration">
<span id="int-network"></span><h2>Network Integration<a class="headerlink" href="#network-integration" title="Permalink to this headline">¶</a></h2>
<p>Create an integrated transit and street network.</p>
<p>If using headways in your integrated network you must first compute the route-stop level headway in this step <a class="reference internal" href="data_loaders.html#headways"><span class="std std-ref">here</span></a>.</p>
<dl class="py function">
<dt id="urbanaccess.network.integrate_network">
<code class="sig-prename descclassname">urbanaccess.network.</code><code class="sig-name descname">integrate_network</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">urbanaccess_network</span></em>, <em class="sig-param"><span class="n">headways</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">urbanaccess_gtfsfeeds_df</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">headway_statistic</span><span class="o">=</span><span class="default_value">'mean'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#urbanaccess.network.integrate_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an integrated network comprised of transit and OSM nodes and edges
by connecting the transit network with the osm network.
travel time is in units of minutes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>urbanaccess_network</strong><span class="classifier">object</span></dt><dd><p>ua_network object with transit_edges, transit_nodes,
osm_edges, osm_nodes</p>
</dd>
<dt><strong>headways</strong><span class="classifier">bool, optional</span></dt><dd><p>if true, route stop level headways calculated in a previous step
will be applied to the osm to transit connector
edge travel time weights as an approximate measure
of average passenger transit stop waiting time.</p>
</dd>
<dt><strong>urbanaccess_gtfsfeeds_df</strong><span class="classifier">object, optional</span></dt><dd><p>required if headways is true; the gtfsfeeds_dfs object that holds
the corresponding headways and stops DataFrames</p>
</dd>
<dt><strong>headway_statistic</strong><span class="classifier">{‘mean’, ‘std’, ‘min’, ‘max’}, optional</span></dt><dd><p>required if headways is true; route stop headway
statistic to apply to the osm to transit connector edges:
mean, std, min, max. Default is mean.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>urbanaccess_network</strong><span class="classifier">object</span></dt><dd></dd>
<dt><strong>urbanaccess_network.transit_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>urbanaccess_network.transit_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>urbanaccess_network.osm_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>urbanaccess_network.osm_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>urbanaccess_network.net_connector_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>urbanaccess_network.net_edges</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
<dt><strong>urbanaccess_network.net_nodes</strong><span class="classifier">pandas.DataFrame</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="save-network">
<span id="id1"></span><h2>Save Network<a class="headerlink" href="#save-network" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="urbanaccess.network.save_network">
<code class="sig-prename descclassname">urbanaccess.network.</code><code class="sig-name descname">save_network</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">urbanaccess_network</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">'data'</span></em>, <em class="sig-param"><span class="n">overwrite_key</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">overwrite_hdf5</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#urbanaccess.network.save_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a urbanaccess_network integrated nodes and edges to a node and edge
table in a hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>urbanaccess_network</strong><span class="classifier">object</span></dt><dd><p>urbanaccess_network object with net_edges and net_nodes DataFrames</p>
</dd>
<dt><strong>filename</strong><span class="classifier">string</span></dt><dd><p>name of the hdf5 file to save with .h5 extension</p>
</dd>
<dt><strong>dir</strong><span class="classifier">string, optional</span></dt><dd><p>directory to save hdf5 file</p>
</dd>
<dt><strong>overwrite_key</strong><span class="classifier">bool, optional</span></dt><dd><p>if true any existing table with the specified key name will be
overwritten</p>
</dd>
<dt><strong>overwrite_hdf5</strong><span class="classifier">bool, optional</span></dt><dd><p>if true any existing hdf5 file with the specified name in the
specified directory will be overwritten</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="load-network">
<span id="id2"></span><h2>Load Network<a class="headerlink" href="#load-network" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="urbanaccess.network.load_network">
<code class="sig-prename descclassname">urbanaccess.network.</code><code class="sig-name descname">load_network</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dir</span><span class="o">=</span><span class="default_value">'data'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#urbanaccess.network.load_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an integrated network node and edge data from a hdf5 file to
a urbanaccess_network object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dir</strong><span class="classifier">string, optional</span></dt><dd><p>directory to read hdf5 file</p>
</dd>
<dt><strong>filename</strong><span class="classifier">string</span></dt><dd><p>name of the hdf5 file to read with .h5 extension</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ua_network</strong><span class="classifier">object</span></dt><dd><p>urbanaccess_network object with net_edges and net_nodes DataFrames</p>
</dd>
<dt><strong>ua_network.net_edges</strong><span class="classifier">object</span></dt><dd></dd>
<dt><strong>ua_network.net_nodes</strong><span class="classifier">object</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot.html" class="btn btn-neutral float-right" title="Plot Networks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="data_loaders.html" class="btn btn-neutral float-left" title="Download and Load Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, UrbanSim Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>